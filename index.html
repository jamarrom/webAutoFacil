<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Montserrat:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="css/reset.css" />
		<link rel="stylesheet" href="css/global.css" />
		<link rel="stylesheet" href="css/app.css" />
		<title>AutoFacil</title>
		<link rel="icon" type="image/png" href="favicon.png" sizes="32x32">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
		<style>
			/* ================================================================
			   ESTILOS PARA EL NUEVO SLIDER DE AUTOS DESTACADOS
			   Manteniendo 100% el diseño original pero mejorando funcionalidad
			================================================================ */
			
			/* Contenedor del track - mantiene diseño original */
			.app-container6 {
				display: flex;
				align-items: flex-start;
				gap: 16px;
				transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
				will-change: transform;
			}
			
			/* Asegurar que las imágenes de fondo funcionen correctamente */
			.card5[style*="background-image"] {
				background-size: cover !important;
				background-position: center !important;
			}
			
			/* Responsivo manteniendo proporciones originales */
			@media (max-width: 1200px) {
				.card5 { 
					flex: 0 0 calc(33.33% - 12px); /* 3 tarjetas */
				}
			}
			
			@media (max-width: 900px) {
				.card5 { 
					flex: 0 0 calc(50% - 12px); /* 2 tarjetas */
				}
			}
			
			@media (max-width: 600px) {
				.card5 { 
					flex: 0 0 calc(100% - 12px); /* 1 tarjeta */
				}
				.circle-btn1 { right: -10px; }
				.circle-btn2 { left: -10px; }
			}
			
		</style>
	</head>

	<body>
		<header class="app-header">
            <div class="header-container">
                <!-- Logo -->
                <h1 href="#" class="header-logo">
                <span>AutoFácil - Credito Inmediato</span>
                </h1>

                <!-- BOTÓN HAMBURGUESA (nuevo) -->
                <button class="hamburger" aria-label="Menú" id="hamburger">
                <i class="fas fa-bars"></i>
                </button>

                <!-- Menú (solo añadimos id="main-nav") -->
                <nav class="header-nav" id="main-nav">
                <ul class="nav-list">
                    <li><a href="#" class="nav-link active">Inicio</a></li>
                    <li><a href="/todos-los-autos/" class="nav-link">Catálogo</a></li>
                    <li><a href="/remates" class="nav-link">Remates</a></li>
                    <li><a href="/nosotros" class="nav-link">Nosotros</a></li>
                    <li><a href="/contacto" class="nav-link">Contacto</a></li>
                </ul>
                </nav>

                <!-- Todo lo demás igual -->
                <div class="header-right">
                <div class="social-icons">
                    <a href="https://www.facebook.com/autofacil.tabasco/" aria-label="Facebook" target="_blank"><img src="../img/icons/facebook.svg" alt=""></a>
                    <a href="https://www.instagram.com/autofaciltab/" aria-label="Instagram" target="_blank"><img src="../img/icons/instagram.svg" alt=""></a>
                </div>
                <a href="/contacto" class="btn-demo hover-bright">Agendar Demo</a>
                </div>
            </div>
        </header>
		<div class="app">
			
			<div class="app-home-page">
				

				<div class="app-hero-slider">
					<div class="hero-slides" id="hero-slides">
						<div style="text-align:center; padding:8rem 2rem; color:white; background: linear-gradient(135deg, #1e3a8a, #3b82f6);">
						<h1 style="font-size:3rem; margin-bottom:1rem;">Cargando slider...</h1>
						</div>
					</div>

					<!-- Puntitos dinámicos -->
					<div class="app-container2" id="hero-dots"></div>
				</div>
				
				<div class="app-vehicle-type card1">
					<div class="app-container3">
						<h2 class="app-subtitle1">¿Que tipo de vehículo buscas?</h2>
						<p class="app-text-paragraph2 text1">Encuentra el auto perfecto para ti</p>
					</div>
					
					<div class="app-container4">
						<div class="button btn1" data-value="SEDAN">
							<div class="button-circle" style="background-image: url(assets/button-circle-container/button-icon1.svg); background-position: center; background-repeat: no-repeat;">
							</div>
							<p class="button-text">Sedán</p>
						</div>

						<div class="button btn2" data-value="SUV">
							<div class="button-circle" style="background-image: url(assets/button-circle-container/button-icon2.svg); background-position: center; background-repeat: no-repeat;">
							</div>
							<p class="button-text">SUV</p>
						</div>

						<div class="button btn3" data-value="COUPE">
							<div class="button-circle" style="background-image: url(assets/button-circle-container/button-icon3.svg); background-position: center; background-repeat: no-repeat;">
							</div>
							<p class="button-text">Cupé</p>
						</div>

						<div class="button btn4" data-value="HATCHBACK">
							<div class="button-circle" style="background-image: url(assets/button-circle-container/button-icon4.svg); background-position: center; background-repeat: no-repeat;">
							</div>
							<p class="button-text">Hatchback</p>
						</div>

						<div class="button btn5" data-value="TRUCK">
							<div class="button-circle" style="background-image: url(assets/button-circle-container/button-icon2.svg); background-position: center; background-repeat: no-repeat;">
							</div>
							<p class="button-text">Camioneta</p>
						</div>
						</div>
				</div>
				
				<div class="app-section1">
                <div class="container-b container6">
                    <h2 class="container-subtitle">Autos Destacados</h2>
                    <p class="container-text1">Descubre nuestra selección premium de vehículos</p>
                </div>
                
                <div class="app-container5">
                    <div class="app-group">
                        <div class="app-container6" id="featured-slider">
							<div style="text-align:center; padding:4rem; color:#666;">
								Cargando autos destacados...
							</div>
                        </div>
                    </div>
                    
                    <!-- Flechas - Manteniendo el diseño original pero con funcionalidad -->
					<div class="circle-button circle-btn1"id="featured-next" style="background-image: url('assets/circle-button/circle-button-icon1.svg'); background-repeat: no-repeat; background-position: center;">
					</div>
					<div class="circle-button circle-btn2" id="featured-prev" style="background-image: url('assets/circle-button/circle-button-icon2.svg'); background-repeat: no-repeat; background-position: center;">
					</div>

					<!-- Puntitos - Manteniendo diseño original -->
					<div class="slider-indicators" id="featured-indicators"></div>
                </div>
            </div>
				
				<!-- INVENTARIO CON FILTROS -->
				<div class="app-section2" id="app-section2">
				<div class="container-b container7">
					<h2 class="container-subtitle">Explora Nuestro Inventario</h2>
					<p class="container-text1">Encuentra el vehículo perfecto para tus necesidades</p>
				</div>

				<div class="inventory-wrapper">
					
					<!-- FILTROS -->
					<aside class="filters-sidebar">
						<div class="filters-header">
							<h3 class="filters-title">Filtros</h3>
							<button class="filters-reset">Restablecer</button>
						</div>

						<!-- Filtros activos -->
						<div class="active-filters"></div>

						<!-- Año -->
						<div class="filter-group">
							<label class="filter-label">Rango de Año</label>
							<div class="range-slider-container">
							<div class="range-slider-track">
								<div class="range-slider-fill"></div>
							</div>
							<input type="range" min="2020" max="2024" value="2020" class="range-min">
							<input type="range" min="2020" max="2024" value="2024" class="range-max">
							</div>
							<div class="range-values">
							<span class="range-value-display">2020</span>
							<span class="range-value-display">2024</span>
							</div>
						</div>

						<!-- Precio -->
						<div class="filter-group">
							<label class="filter-label">Rango de Precio</label>
							<div class="range-slider-container">
							<div class="range-slider-track">
								<div class="range-slider-fill"></div>
							</div>
							<input type="range" min="0" max="300000" step="1000" value="0" class="range-min">
							<input type="range" min="0" max="300000" step="1000" value="300000" class="range-max">
							</div>
							<div class="range-values">
							<span class="range-value-display">$0</span>
							<span class="range-value-display">$300,000</span>
							</div>
						</div>

						<!-- Resto de filtros (sin cambios) -->
						<div class="filter-group">
							<label class="filter-label">Marca</label>
							<div class="checkbox-group" id="brand-filters">
								<!-- Se llenará con JS -->
							</div>
						</div>

					<!-- Motor -->
					<div class="filter-group">
						<label class="filter-label">Tipo de Motor</label>
						<div class="checkbox-group">
						<label><input type="checkbox" name="fuel" value="Gasolina"> Gasolina</label>
						<label><input type="checkbox" name="fuel" value="Diésel"> Diésel</label>
						<label><input type="checkbox" name="fuel" value="Eléctrico"> Eléctrico</label>
						<label><input type="checkbox" name="fuel" value="Híbrido"> Híbrido</label>
						</div>
					</div>

					<!-- Tipo -->
					<div class="filter-group">
						<label class="filter-label">Tipo de Vehículo</label>
						<div class="checkbox-group">
							<label><input type="checkbox" name="type" value="SEDAN"> Sedán</label>
							<label><input type="checkbox" name="type" value="SUV"> SUV</label>
							<label><input type="checkbox" name="type" value="COUPE"> Cupé</label>
							<label><input type="checkbox" name="type" value="HATCHBACK"> Hatchback</label>
							<label><input type="checkbox" name="type" value="TRUCK"> Camioneta</label>
						</div>
					</div>
					</aside>

					<!-- GRID DE AUTOS -->
					<div class="inventory-main">
						<div class="inventory-header">
							<p class="inventory-count">Cargando vehículos...</p>
							<div class="sort-by">
							<label>Ordenar por:</label>
							<select class="sort-select">
								<option value="featured">Destacados</option>
								<option value="price-asc">Precio: menor a mayor</option>
								<option value="price-desc">Precio: mayor a menor</option>
								<option value="year-desc">Año: más reciente</option>
							</select>
							</div>
						</div>

						<div class="inventory-grid" id="cars-grid">
							<!-- Aquí se inyectarán los autos -->
						</div>

						<button class="btn app-btn2 hover-bright" onclick="window.location.href='/todos-los-autos'">
							Ver Todos los Autos
						</button>
					</div>
				</div>
			</div>
				
				<div class="app-section3 card1">
					<h2 class="app-subtitle3">¿Listo para Manejar el Auto de tus Sueños?</h2>
					<p class="app-text-paragraph5 text2">
						Obtén aprobación de crédito instantánea y maneja hoy mismo
					</p>
					
					<div class="container-a container8">
						<a href="/contacto" class="container-btn container-btn1 hover-bright">Agendar Demo</a>
						<a href="/contacto" class="container-btn container-btn2 hover-dark">¿Quieres Vender tu Auto?</a>
					</div>
				</div>
			</div>
			
			<div class="app-footer">
				<div class="footer-main">
					<!-- Columna 1: Logo y descripción -->
					<div class="footer-brand">
						<img src="./img/logoFooter.png" class="footer-logo" alt="AutoFácil Logo" />
						<p class="footer-description">
							Tu socio confiable para vehículos premium. Calidad, confiabilidad y servicio excepcional.
						</p>

						<!-- ICONOS DE REDES SOCIALES -->
						<div class="footer-social">
							<a href="https://facebook.com/autofacil" target="_blank" class="social-link" aria-label="Síguenos en Facebook">
							<img src="img/icons/facebook.svg" alt="Facebook" class="social-icon" />
							</a>
							<a href="https://instagram.com/autofacil" target="_blank" class="social-link" aria-label="Síguenos en Instagram">
							<img src="img/icons/instagram.svg" alt="Instagram" class="social-icon" />
							</a>
							<a href="https://twitter.com/autofacil" target="_blank" class="social-link" aria-label="Síguenos en Twitter">
							<img src="img/icons/twitter.svg" alt="Twitter" class="social-icon" />
							</a>
						</div>
					</div>

					<!-- Columna 2: Enlaces Rápidos -->
					<div class="footer-column">
					<h3 class="footer-heading">Enlaces Rápidos</h3>
					<ul class="footer-list">
						<li><a href="#">Inicio</a></li>
						<li><a href="/todos-los-autos">Catálogo</a></li>
						<li><a href="/nosotros">Nosotros</a></li>
						<li><a href="/contacto">Contacto</a></li>
					</ul>
					</div>

					<!-- Columna 3: Servicios -->
					<div class="footer-column">
					<h3 class="footer-heading">Servicios</h3>
					<ul class="footer-list">
						
						<li><a href="/vende-tu-auto">Vender tu Auto</a></li>
						<li><a href="/terminos-y-condiciones/">Términos y Condiciones</a></li>
						<li><a href="/aviso-de-privacidad">Aviso de Privacidad</a></li>
					</ul>
					</div>

					<!-- Columna 4: Contáctanos -->
					<div class="footer-column">
					<h3 class="footer-heading">Contáctanos</h3>
					<ul class="footer-contact">
						<li>
							<object data="../assets/app-icon.svg" type="image/svg+xml"></object>
							<span><a href="https://www.google.com/maps/place/Auto+F%C3%A1cil/@17.9886663,-92.9302648,17z/data=!3m1!4b1!4m6!3m5!1s0x85edd82fdf4fd289:0x183cefa580c5c577!8m2!3d17.9886612!4d-92.9276899!16s%2Fg%2F11b7llyv5k!5m1!1e1?entry=ttu&g_ep=EgoyMDI1MTIwOS4wIKXMDSoASAFQAw%3D%3D" target="_blank">Paseo Tabasco esq. 27 de Febrero, Nueva Villahermosa, 86070.</a><br />
							<a href="https://www.google.com/maps/place/Plaza+Paty/@17.9661531,-92.9544807,17z/data=!3m2!4b1!5s0x85edd76d7cefb4ad:0xcaa162cbfcfc69f!4m6!3m5!1s0x85edd76e0488ed35:0x37c710471df9edf0!8m2!3d17.966148!4d-92.9519058!16s%2Fg%2F12lt2zwx3!5m1!1e1?entry=ttu&g_ep=EgoyMDI1MTIwOS4wIKXMDSoASAFQAw%3D%3D" target="_blank">Periférico 1408, Tamulté de las Barrancas, 86150.<br />
							Villahermosa, Tabasco.</span></a>
						</li>
						<li>
							<object data="assets/list-item/list-item-icon1.svg" type="image/svg+xml"></object>
							<span><a href="tel:+525512345678">+52 (55) 1234-5678</a></span>
						</li>
						<li>
							<a href="mailto: info@autofacil.com.mx">
								<object data="assets/list-item/list-item-icon2.svg" type="image/svg+xml"></object>
								<span>info@autofacil.com.mx</span>
							</a>
						</li>
					</ul>
					</div>
				</div>

				<!-- Línea divisoria y copyright -->
				<div class="footer-bottom">
					<p class="footer-copyright">
					© 2025 AutoFácil - Crédito Inmediato. Todos los derechos reservados.
					</p>
					<div class="footer-links">
					<a href="#" class="footer-link">Política de Privacidad</a>
					<span class="footer-separator">•</span>
					<a href="/terminos-y-condiciones/" class="footer-link">Términos y Condiciones</a>
					</div>
				</div>
			</div>
		</div>
		
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				// ========================================
				// 1. CONFIGURACIÓN INICIAL Y VARIABLES
				// ========================================
				const API_HERO_SLIDER = 'http://54.205.241.136/api/public/slider/home'
				const API_URL = 'http://54.205.241.136/api/public/cars?limit=6';
				let allCars = [];
				let currentFilteredCars = [];
				
				// Elementos del DOM
				const grid = document.getElementById('cars-grid');
				const countEl = document.querySelector('.inventory-count');
				const resetBtn = document.querySelector('.filters-reset');
				const sortSelect = document.querySelector('.sort-select');
				const activeFiltersContainer = document.querySelector('.active-filters');
				
				// Sliders de rango
				const yearMin = document.querySelector('.range-min');
				const yearMax = document.querySelector('.range-max');
				const priceMin = document.querySelectorAll('.range-min')[1];
				const priceMax = document.querySelectorAll('.range-max')[1];
				
				const yearValMin = document.querySelectorAll('.range-values span')[0];
				const yearValMax = document.querySelectorAll('.range-values span')[1];
				const priceValMin = document.querySelectorAll('.range-values span')[2];
				const priceValMax = document.querySelectorAll('.range-values span')[3];
				
				const yearFill = document.querySelector('.range-slider-fill');
				const priceFill = document.querySelectorAll('.range-slider-fill')[1];

				// ========================================
				// 2. FUNCIONES PARA SLIDERS DE RANGO
				// ========================================
				function updateSliderFill(min, max, fill) {
					const minVal = parseInt(min.value);
					const maxVal = parseInt(max.value);
					const minPercent = ((minVal - min.min) / (min.max - min.min)) * 100;
					const maxPercent = ((maxVal - max.min) / (max.max - max.min)) * 100;
					fill.style.left = `${minPercent}%`;
					fill.style.width = `${maxPercent - minPercent}%`;
				}
				
				function updateYear() {
					yearValMin.textContent = yearMin.value;
					yearValMax.textContent = yearMax.value;
					updateSliderFill(yearMin, yearMax, yearFill);
				}
				
				function updatePrice() {
					priceValMin.textContent = `$${Number(priceMin.value).toLocaleString()}`;
					priceValMax.textContent = `$${Number(priceMax.value).toLocaleString()}`;
					updateSliderFill(priceMin, priceMax, priceFill);
				}
				
				yearMin.addEventListener('input', updateYear);
				yearMax.addEventListener('input', updateYear);
				priceMin.addEventListener('input', updatePrice);
				priceMax.addEventListener('input', updatePrice);

				// ========================================
				// 3. CARGAR DATOS DE LA API
				// ========================================
				async function loadCars() {
					try {
						const res = await fetch(API_URL);
						const data = await res.json();
						allCars = data.cars || [];
						
						if (allCars.length === 0) {
							countEl.textContent = 'No hay vehículos disponibles';
							return;
						}
						
						// Normalizar datos de la API
						allCars = allCars.map(car => ({
							...car,
							fuelTypeNormalized: car.fuelType === 'GASOLINE' ? 'Gasolina' : 
											car.fuelType === 'DIESEL' ? 'Diésel' : 
											car.fuelType === 'ELECTRIC' ? 'Eléctrico' : 
											'Híbrido',
							transmissionNormalized: car.transmission === 'AUTOMATIC' ? 'Automática' : 'Manual'
						}));
						
						// Calcular rangos dinámicos basados en los datos reales
						const years = allCars.map(car => car.year).filter(year => year);
						const prices = allCars.map(car => car.price).filter(price => price);
						
						const minYear = years.length > 0 ? Math.min(...years) : 2020;
						const maxYear = years.length > 0 ? Math.max(...years) : 2024;
						const minPrice = prices.length > 0 ? Math.min(...prices) : 0;
						const maxPrice = prices.length > 0 ? Math.max(...prices) : 300000;
						
						// Ajustar los sliders
						yearMin.min = minYear;
						yearMin.max = maxYear;
						yearMin.value = minYear;
						
						yearMax.min = minYear;
						yearMax.max = maxYear;
						yearMax.value = maxYear;
						
						priceMin.min = 0;
						priceMin.max = Math.ceil(maxPrice / 1000) * 1000;
						priceMin.value = 0;
						
						priceMax.min = 0;
						priceMax.max = Math.ceil(maxPrice / 1000) * 1000;
						priceMax.value = Math.ceil(maxPrice / 1000) * 1000;
						
						updateYear();
						updatePrice();
						
						renderBrands();
						applyFiltersAndSort();
						
					} catch (err) {
						countEl.textContent = 'Error cargando vehículos';
						console.error(err);
					}
				}
				
				// ========================================
				// 4. RENDERIZAR MARCAS (FILTROS)
				// ========================================
				function renderBrands() {
					const container = document.getElementById('brand-filters');
					const brands = [...new Set(allCars.map(car => car.brand))].sort();
					
					container.innerHTML = brands.map(brand => `
						<label><input type="checkbox" name="brand" value="${brand}"> ${brand.replace(/_/g, ' ')}</label>
					`).join('');
					
					setupFilterEvents();
				}
				
				// ========================================
				// 5. RENDERIZAR AUTOS EN EL GRID
				// ========================================
				function renderCars(cars) {
					if (!cars || cars.length === 0) {
						grid.innerHTML = '<div class="no-results" style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666;"><p>No se encontraron vehículos con los filtros seleccionados</p></div>';
						return;
					}
					
					grid.innerHTML = cars.map(car => `
						<div class="car-card"
							data-brand="${car.brand}"
							data-year="${car.year}"
							data-price="${car.price}"
							data-fuel="${car.fuelTypeNormalized}"
							data-type="${car.type}"
							data-id="${car.id}">
							<div onclick="window.location.href='detalle-auto/?id=${car.id}'" class="car-image" style="background-image: url('http://54.205.241.136${car.primaryImage || '/img/placeholder.jpg'}')">
								${car.isFeatured ? '<span class="badge">Destacado</span>' : ''}
							</div>
							<div class="car-info">
								<h3 onclick="window.location.href='detalle-auto/?id=${car.id}'">${car.title || `${car.brand.replace(/_/g,' ')} ${car.model}`}</h3>
								<p class="year">${car.year}</p>
								<div class="specs">
									<div class="spec-item">
										<object data="./img/Icon-km.svg" type="image/svg+xml" class="spec-icon"></object>
										<span>${(car.mileage || 0).toLocaleString()} km</span>
									</div>
									<div class="spec-item">
										<object data="./img/Icon-gasolina.png" type="image/svg+xml" class="spec-icon"></object>
										<span>${car.fuelTypeNormalized}</span>
									</div>
									<div class="spec-item">
										<object data="./img/Icon-automatica.png" type="image/svg+xml" class="spec-icon"></object>
										<span>${car.transmissionNormalized}</span>
									</div>
								</div>
								<div class="price-action">
									<strong>$${(car.price || 0).toLocaleString()}</strong>
									<button class="btn" onclick="window.location.href='detalle-auto/?id=${car.id}'">Ver Detalles</button>
								</div>
							</div>
						</div>
					`).join('');
				}
				
				// ========================================
				// 6. FILTRADO DE AUTOS
				// ========================================
				function filterCars() {
					if (allCars.length === 0) return [];
					
					const currentMinYear = parseInt(yearMin.value);
					const currentMaxYear = parseInt(yearMax.value);
					const currentMinPrice = parseInt(priceMin.value);
					const currentMaxPrice = parseInt(priceMax.value);
					
					const maxPossibleYear = parseInt(yearMax.max);
					const minPossibleYear = parseInt(yearMin.min);
					const maxPossiblePrice = parseInt(priceMax.max);
					const minPossiblePrice = parseInt(priceMin.min);
					
					const isYearDefault = (currentMinYear === minPossibleYear && currentMaxYear === maxPossibleYear);
					const isPriceDefault = (currentMinPrice === minPossiblePrice && currentMaxPrice === maxPossiblePrice);
					
					const selectedBrands = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map(i => i.value);
					const selectedFuels = Array.from(document.querySelectorAll('input[name="fuel"]:checked')).map(i => i.value);
					const selectedTypes = Array.from(document.querySelectorAll('input[name="type"]:checked')).map(i => i.value);
					
					return allCars.filter(car => {
						if (!isYearDefault && (car.year < currentMinYear || car.year > currentMaxYear)) return false;
						if (!isPriceDefault && (car.price < currentMinPrice || car.price > currentMaxPrice)) return false;
						if (selectedBrands.length > 0 && !selectedBrands.includes(car.brand)) return false;
						if (selectedFuels.length > 0 && !selectedFuels.includes(car.fuelTypeNormalized)) return false;
						if (selectedTypes.length > 0 && !selectedTypes.includes(car.type)) return false;
						return true;
					});
				}
				
				// ========================================
				// 7. ORDENAR AUTOS
				// ========================================
				function sortCars(cars) {
					const sortValue = sortSelect.value;
					
					return [...cars].sort((a, b) => {
						switch (sortValue) {
							case 'price-asc': return a.price - b.price;
							case 'price-desc': return b.price - a.price;
							case 'year-desc': return b.year - a.year;
							case 'featured':
							default:
								if (a.isFeatured && !b.isFeatured) return -1;
								if (!a.isFeatured && b.isFeatured) return 1;
								return b.year - a.year;
						}
					});
				}
				
				// ========================================
				// 8. APLICAR FILTROS Y ORDENAMIENTO
				// ========================================
				function applyFiltersAndSort() {
					currentFilteredCars = filterCars();
					const sortedCars = sortCars(currentFilteredCars);
					
					countEl.textContent = `Mostrando ${sortedCars.length} de ${allCars.length} vehículos`;
					renderCars(sortedCars);
					updateActiveFilters();
				}
				
				// ========================================
				// 9. FILTROS ACTIVOS
				// ========================================
				function updateActiveFilters() {
					activeFiltersContainer.innerHTML = '';
					
					const currentMinYear = parseInt(yearMin.value);
					const currentMaxYear = parseInt(yearMax.value);
					const currentMinPrice = parseInt(priceMin.value);
					const currentMaxPrice = parseInt(priceMax.value);
					
					if (currentMinYear > parseInt(yearMin.min) || currentMaxYear < parseInt(yearMax.max)) {
						activeFiltersContainer.appendChild(createActiveFilterTag(`Año: ${currentMinYear}-${currentMaxYear}`, 'year'));
					}
					
					if (currentMinPrice > 0 || currentMaxPrice < parseInt(priceMax.max)) {
						activeFiltersContainer.appendChild(createActiveFilterTag(
							`$${Number(currentMinPrice).toLocaleString()} - $${Number(currentMaxPrice).toLocaleString()}`,
							'price'
						));
					}
					
					const selectedBrands = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map(i => i.value);
					if (selectedBrands.length > 0) {
						activeFiltersContainer.appendChild(createActiveFilterTag(`Marcas: ${selectedBrands.join(', ')}`, 'brand'));
					}
					
					const selectedFuels = Array.from(document.querySelectorAll('input[name="fuel"]:checked')).map(i => i.value);
					if (selectedFuels.length > 0) {
						activeFiltersContainer.appendChild(createActiveFilterTag(`Motor: ${selectedFuels.join(', ')}`, 'fuel'));
					}
					
					const selectedTypes = Array.from(document.querySelectorAll('input[name="type"]:checked')).map(i => i.value);
					if (selectedTypes.length > 0) {
						activeFiltersContainer.appendChild(createActiveFilterTag(`Tipo: ${selectedTypes.join(', ')}`, 'type'));
					}
				}
				
				function createActiveFilterTag(text, type) {
					const div = document.createElement('div');
					div.className = 'active-filter-tag';
					div.innerHTML = `${text} <button data-filter="${type}">×</button>`;
					div.querySelector('button').addEventListener('click', () => clearFilter(type));
					return div;
				}
				
				function clearFilter(type) {
					switch (type) {
						case 'year':
							yearMin.value = yearMin.min;
							yearMax.value = yearMax.max;
							updateYear();
							break;
						case 'price':
							priceMin.value = 0;
							priceMax.value = priceMax.max;
							updatePrice();
							break;
						case 'brand':
							document.querySelectorAll('input[name="brand"]').forEach(c => c.checked = false);
							break;
						case 'fuel':
							document.querySelectorAll('input[name="fuel"]').forEach(c => c.checked = false);
							break;
						case 'type':
							document.querySelectorAll('input[name="type"]').forEach(c => c.checked = false);
							break;
							break;
					}
					applyFiltersAndSort();
				}
				
				// ========================================
				// 10. CONFIGURAR EVENTOS DE FILTROS
				// ========================================
				function setupFilterEvents() {
					document.querySelectorAll('input[type="checkbox"]').forEach(el => {
						el.addEventListener('change', applyFiltersAndSort);
					});
					
					yearMin.addEventListener('change', applyFiltersAndSort);
					yearMax.addEventListener('change', applyFiltersAndSort);
					priceMin.addEventListener('change', applyFiltersAndSort);
					priceMax.addEventListener('change', applyFiltersAndSort);
					
					sortSelect.addEventListener('change', applyFiltersAndSort);
					
					resetBtn.addEventListener('click', () => {
						yearMin.value = yearMin.min;
						yearMax.value = yearMax.max;
						priceMin.value = 0;
						priceMax.value = priceMax.max;
						updateYear();
						updatePrice();
						document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
						sortSelect.value = 'featured';
						applyFiltersAndSort();
					});
				}

				// ========================================
				// 11. AUTOS DESTACADOS - MEJORADA PERO MANTENIENDO DISEÑO
				// ========================================
				async function loadFeaturedCars() {
					try {
						const res = await fetch('http://54.205.241.136/api/public/cars/featured');
						const data = await res.json();
						const cars = data.cars || [];
						
						const container = document.getElementById('featured-slider');
						const indicators = document.getElementById('featured-indicators');
						
						if (cars.length === 0) {
							container.innerHTML = '<p style="grid-column:1/-1;text-align:center;padding:4rem;color:#999;">No hay autos destacados en este momento</p>';
							indicators.innerHTML = '';
							return;
						}
						
						// Renderizar tarjetas MANTENIENDO DISEÑO ORIGINAL
						container.innerHTML = cars.map(car => `
							<a href="detalle-auto/?id=${car.id}" class="card5" style="background-image: url('http://54.205.241.136${car.primaryImage || '/img/placeholder.jpg'}');">
								<button class="btn-badge card-btn-badge2 hover-bright">Destacado</button>
								<h2 class="card-subtitle3 subtitle">${car.title || `${car.brand} ${car.model}`}</h2>
								<p class="card-text-paragraph3 text1">${car.year}</p>
								<p class="card-text-paragraph4 text2">$${(car.price || 0).toLocaleString()}</p>
							</a>
						`).join('');
						
						initFeaturedSlider();
					} catch (err) {
						console.error('Error cargando destacados:', err);
					}
				}
				
				let featuredIndex = 0;
				let cardsPerView = 4;
				
				function initFeaturedSlider() {
					const container = document.getElementById('featured-slider');
					const cards = container.querySelectorAll('.card5');
					const btnPrev = document.getElementById('featured-prev');
					const btnNext = document.getElementById('featured-next');
					const indicatorsContainer = document.getElementById('featured-indicators');
					
					if (cards.length === 0) {
						indicatorsContainer.innerHTML = '';
						return;
					}
					
					// Calcular cuántas tarjetas caben según el ancho de pantalla
					function updateCardsPerView() {
						const width = window.innerWidth;
						if (width < 600) cardsPerView = 1;
						else if (width < 900) cardsPerView = 2;
						else if (width < 1200) cardsPerView = 3;
						else cardsPerView = 4;
						
						// Ajustar el índice si es necesario
						const maxIndex = Math.max(0, cards.length - cardsPerView);
						if (featuredIndex > maxIndex) {
							featuredIndex = maxIndex;
						}
						
						updateSlider();
						updateIndicators();
					}
					
					// Actualizar posición del slider
					function updateSlider() {
						if (cards.length === 0 || cardsPerView >= cards.length) {
							container.style.transform = 'translateX(0)';
							return;
						}
						
						const cardWidth = cards[0].offsetWidth + 16; // Incluye el gap
						container.style.transform = `translateX(${-featuredIndex * cardWidth}px)`;
					}
					
					// Actualizar indicadores
					function updateIndicators() {
						const totalCards = cards.length;
						if (totalCards <= cardsPerView) {
							indicatorsContainer.innerHTML = '';
							indicatorsContainer.style.display = 'none';
							return;
						}
						
						indicatorsContainer.style.display = 'flex';
						const totalPages = Math.max(1, totalCards - cardsPerView + 1);
						indicatorsContainer.innerHTML = '';
						
						for (let i = 0; i < totalPages; i++) {
							const dot = document.createElement('button');
							dot.className = 'slider-indicator';
							if (i === featuredIndex) dot.classList.add('active');
							dot.setAttribute('aria-label', `Ir a slide ${i + 1}`);
							indicatorsContainer.appendChild(dot);
							
							dot.addEventListener('click', () => {
								featuredIndex = i;
								updateSlider();
								highlightDot();
							});
						}
					}
					
					// Resaltar dot activo
					function highlightDot() {
						const dots = indicatorsContainer.querySelectorAll('.slider-indicator');
						dots.forEach((dot, i) => {
							dot.classList.toggle('active', i === featuredIndex);
						});
					}
					
					// Eventos para flechas
					btnPrev.addEventListener('click', () => {
						if (featuredIndex > 0) {
							featuredIndex--;
							updateSlider();
							highlightDot();
						}
					});
					
					btnNext.addEventListener('click', () => {
						const maxIndex = Math.max(0, cards.length - cardsPerView);
						if (featuredIndex < maxIndex) {
							featuredIndex++;
							updateSlider();
							highlightDot();
						}
					});
					
					// Inicializar
					updateCardsPerView();
					updateIndicators();
					
					// Escuchar cambios en el tamaño de ventana
					let resizeTimeout;
					window.addEventListener('resize', () => {
						clearTimeout(resizeTimeout);
						resizeTimeout = setTimeout(() => {
							updateCardsPerView();
						}, 150);
					});
					
					// Inicializar posición
					updateSlider();
				}

				// ========================================
				// 12. HERO SLIDER MODERNO – SOPORTA VIDEO E IMAGEN
				// ========================================
				async function loadHeroSlider() {
					const slidesContainer = document.getElementById('hero-slides');
					const dotsContainer = document.getElementById('hero-dots');

					try {
						const res = await fetch(API_HERO_SLIDER);
						const slides = await res.json();

						console.log('Slides cargados:', slides);

						if (!Array.isArray(slides) || slides.length === 0) {
							slidesContainer.innerHTML = `
								<div class="hero-slide active">
									<div class="hero-media" style="background-image: url('./img/sliderHome/slider1.jpg');"></div>
									<div class="hero-overlay"></div>
									<div class="app-container1 hero-content">
										<h1 class="app-title">Maneja el Auto de tus Sueños Hoy</h1>
										<p class="app-text-paragraph1">Descubre nuestra colección exclusiva de vehículos premium con aprobación de crédito instantánea</p>
										<div class="container-a container5">
											<a href="/contacto" class="container-btn container-btn1 hover-bright">Agendar Demo</a>
											<a href="/contacto" class="container-btn container-btn2 hover-dark">¿Quieres Vender tu Auto?</a>
										</div>
									</div>
								</div>
							`;
							dotsContainer.innerHTML = '<div class="app-circle-button active"></div>';
							initHeroSlider();
							return;
						}

						const slidesHTML = slides.map((slide, i) => {
							const hasVideo = slide.videoUrl && slide.videoUrl.trim() !== '';
							const mediaUrl = hasVideo 
								? `http://54.205.241.136${slide.videoUrl}` 
								: `http://54.205.241.136${slide.imageUrl}`;

							return `
							<div class="hero-slide ${i === 0 ? 'active' : ''}">
								${hasVideo ? `
									<video class="hero-video" autoplay muted loop playsinline preload="metadata" poster="http://54.205.241.136${slide.thumbnailUrl || ''}">
										<source src="${mediaUrl}" type="video/mp4">
									</video>
								` : `
									<div class="hero-media" style="background-image:url('${mediaUrl}')"></div>
								`}
								<div class="hero-overlay"></div>
								<div class="app-container1 hero-content">
									<h1 class="app-title">${slide.title || 'Maneja el Auto de tus Sueños Hoy'}</h1>
									<p class="app-text-paragraph1">${slide.subtitle || 'Descubre nuestra colección exclusiva de vehículos premium con aprobación de crédito instantánea'}</p>
									<div class="container-a container5">
										<a href="/contacto" class="container-btn container-btn1 hover-bright">Agendar Demo</a>
										<a href="/contacto" class="container-btn container-btn2 hover-dark">¿Quieres Vender tu Auto?</a>
									</div>
								</div>
							</div>`;
						}).join('');

						slidesContainer.innerHTML = slidesHTML;
						dotsContainer.innerHTML = slides.map((_, i) => `<div class="app-circle-button ${i===0?'active':''}"></div>`).join('');
						initHeroSlider();

					} catch (err) {
						console.error('Error cargando hero slider:', err);
						slidesContainer.innerHTML = `<div class="hero-slide active"><div class="hero-media" style="background-image:url('./img/sliderHome/slider1.jpg')"></div><div class="hero-overlay"></div><div class="app-container1 hero-content"><h1 class="app-title">Bienvenido a AutoFácil</h1></div></div>`;
						dotsContainer.innerHTML = '<div class="app-circle-button active"></div>';
						initHeroSlider();
					}
				}

				function initHeroSlider() {
					const slides = document.querySelectorAll('.hero-slide');
					const dots = document.querySelectorAll('.app-circle-button');
					let current = 0;
					const total = slides.length;

					document.querySelectorAll('.hero-video').forEach(v => v.play().catch(() => {}));

					function show(n) {
						slides[current].classList.remove('active');
						dots[current].classList.remove('active');
						current = n;
						slides[current].classList.add('active');
						dots[current].classList.add('active');
						const vid = slides[current].querySelector('video');
						if (vid) { vid.currentTime = 0; vid.play().catch(() => {}); }
					}

					dots.forEach((d,i) => d.addEventListener('click', () => show(i)));
					setInterval(() => show((current + 1) % total), 7000);
				}

				// ========================================
				// 13. INICIALIZACIÓN
				// ========================================
				updateYear();
				updatePrice();
				loadCars();
				loadHeroSlider();
				loadFeaturedCars();
				setupFilterEvents();

				// === MENÚ HAMBURGUESA ===
				const hamburger = document.getElementById('hamburger');
				const nav = document.getElementById('main-nav');
				const body = document.body;
				let overlay = document.querySelector('.menu-overlay');
				if (!overlay) {
					overlay = document.createElement('div');
					overlay.className = 'menu-overlay';
					body.appendChild(overlay);
				}
				hamburger.addEventListener('click', () => {
					nav.classList.toggle('open');
					body.classList.toggle('menu-open');
					hamburger.querySelector('i').classList.toggle('fa-bars');
					hamburger.querySelector('i').classList.toggle('fa-xmark');
				});
				overlay.addEventListener('click', () => {
					nav.classList.remove('open');
					body.classList.remove('menu-open');
					hamburger.querySelector('i').classList.replace('fa-xmark', 'fa-bars');
				});
				document.querySelectorAll('.nav-link').forEach(link => {
					link.addEventListener('click', () => {
						nav.classList.remove('open');
						body.classList.remove('menu-open');
						hamburger.querySelector('i').classList.replace('fa-xmark', 'fa-bars');
					});
				});
			});
		</script>

		<script>
			// Selecciona todos los botones
			document.querySelectorAll('.app-container4 .button').forEach(button => {
				button.addEventListener('click', () => {
					const value = button.getAttribute('data-value');
					const checkbox = document.querySelector(`input[name="type"][value="${value}"]`);

					if (checkbox) {
					// Si ya estaba seleccionado, lo deseleccionamos
					if (checkbox.checked) {
						checkbox.checked = false;
						checkbox.dispatchEvent(new Event('change', { bubbles: true }));
					} else {
						// Deseleccionamos todos los demás
						document.querySelectorAll('input[name="type"]').forEach(cb => cb.checked = false);

						// Seleccionamos el actual
						checkbox.checked = true;
						checkbox.dispatchEvent(new Event('change', { bubbles: true }));
					}
					}

					// Scroll hacia la sección
					const section = document.getElementById('app-section2');
					if (section) {
					section.scrollIntoView({ behavior: 'smooth' });
					}
				});
			});

		</script>
	</body>
</html>